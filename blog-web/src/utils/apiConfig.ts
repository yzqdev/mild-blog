import { Article, ListData, Result } from '@/interface/result'
import http from '@/utils/http'
import qs from 'qs'
import { useUserStore } from "@/store/user";

export const loginApi = (loginForm: { username: string; password: string }): Promise<Result<any>> => {
  return http.post(`/auth/login?` + qs.stringify(loginForm))
}

export function getUsers(): Promise<Result<any>> {
  return http.get(`/admin/users`)
}
export const editUser = (user: any) => {
  return http.postForm(`/admin/userEdit`, user)
}
export const delUsers = (id: string) => {
  return http.post(`/admin/del/${id}`)
}
export const unlockUser = (id: string) => {
  return http.post(`/admin/unlock/${id}`)
}
export const regApi = (regForm: { username: string; password: string }) => {
  return http.post(`/auth/reg?username`, regForm)
}

export function getSystemInfo(): Promise<Result<ListData>> {
  return http.get('/admin/blogConfig/list')
}

export const addSystemInfo = (data: object) => {
  return http.post('/admin/blogConfig/add', data)
}
export const editSystemInfo = (data: object) => {
  return http.post('/admin/blogConfig/edit', data)
}
export const delSystemInfo = (data: string) => {
  return http.delete('/admin/blogConfig/del/' + data)
}
export const getLinkList = (data: { page: number; limit: number }) => {
  return http.get(`/admin/link/paging?` + qs.stringify(data))
}
export const editLink = (data: object) => {
  return http.postForm('/admin/link/edit', data)
}
export const delLink = (data: object): Promise<Result<any>> => {
  return http.post ('/admin/link/hide', data)
}
export const clearLink = (data: string): Promise<Result<any>> => {
  return http.delete('/admin/link/clear/' + data)
}

export const getUserInfo = (): Promise<Result<any>> => {
  return http.get('/admin/getUser')
}
export const getBlogList = (data: { page: number; limit: number; deleted: boolean }): Promise<Result<ListData>> => {
  return http.get(`/admin/blog/list?page=${data.page}&limit=${data.limit}&deleted=${data.deleted}`)
}
export const getCommentList = (data: { page: number; limit: number }) => {
  return http.get(`/admin/comment/paging?page=${data.page}&limit=${data.limit}`)
}
export const deleteCommentById = (id: string): Promise<Result<any>> => {
  return http.delete(`/admin/comment/delete/${id}`)
}
export const checkCommentById = (id: string) => {
  return http.post(`/admin/comment/delete/${id}`)
}
export const hideCommentById = (id: string, show: boolean) => {
  return http.post(`/admin/comment/isDel/${id}?show=${show}`)
}
export const getTagList = (data: { page: number; limit: number; show?: boolean }): Promise<Result<ListData>> => {
  return http.get(`/admin/tags/list?` + qs.stringify(data))
}
export const addTag = (data: object) => {
  return http.postForm(`/admin/tags/add`, data)
}
export const EditTagList = (data: object) => {
  return http.post(`/admin/tags/update`, data)
}
export const clearTagById = (data: object): Promise<Result<any>> => {
  return http.post(`/admin/tags/clear/${data}`)
}

export function getCateList(): Promise<Result<any>> {
  return http.get(`/admin/category/list`)
}
export const addCateApi = (data: object) => {
  return http.postForm(`/admin/category/add`, data)
}
export const clearCateApi = (data: string): Promise<Result<any>> => {
  return http.post(`/admin/category/clear/${data}`)
}
export const getCatePaging = (data: { page: number; limit: number }) => {
  return http.get(`/admin/category/paging?page=${data.page}&limit=${data.limit}`)
}

export function addBlog(params: Article): Promise<Result<string>> {
  return http.post('/admin/blog/edit', params)
}
export const clearBlog = (params: string) => {
  return http.post('/admin/blog/clear/' + params)
}
export const deleteBlog = (id: string, restore: boolean = false): Promise<Result<any>> => {
  return http.post(`/admin/blog/delete/${id}?restore=${restore}`)
}
export const hideBlog = (id: string, show: boolean = false): Promise<Result<any>> => {
  return http.post(`/admin/blog/show/${id}?show=${show}`)
}

export function getAdminBlogById(params: string): Promise<Result<any>> {
  return http.get('/admin/blog/get/' + params)
}

export function getSysLogApi(data: { page: number; limit: number }) {
  return http.post('/admin/log?' + qs.stringify(data))
}

export const uploadUrl = `${import.meta.env.VITE_APP_URL}/admin/img/upload`
export const uploadImg = (params: object) => {
  const userStore=useUserStore()
  console.log(userStore.token,"---------------bbbbbb")
  return http.post('/admin/img/upload', params, {
    headers: {
      'Content-Type': 'multipart/form-data',
      token:userStore.token
    },
  })
}
export const getImgs = (data: { page: number; limit: number }): Promise<Result<ListData>> => {
  return http.post('/admin/img/list' ,data)
}
export const delImg = (id: string) => {
  return http.delete('/admin/img/del/' + id)
}
